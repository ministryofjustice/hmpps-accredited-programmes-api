openapi: 3.0.1
info:
  title: Accredited Programmes API
  version: 1.0.0
servers:
  - url: /
paths:
  /courses:
    get:
      tags:
        - Courses
      summary: List all courses
      responses:
        200:
          description: successful operation
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/Course'

  /courses/{courseId}:
    get:
      tags:
        - Courses
      summary: Details for a single course
      parameters:
        - name: courseId
          in: path
          description: A course identifier
          required: true
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: successful operation
          content:
            'application/json':
              schema:
                  $ref: '#/components/schemas/Course'

  /courses/{courseId}/offerings:
    get:
      tags:
        - Course Offerings
      summary: List all offerings for a course
      parameters:
        - name: courseId
          in: path
          description: A course identifier
          required: true
          schema:
            type: string
            format: uuid
      responses:
        200:
          description: successful operation
          content:
            'application/json':
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/CourseOffering'

  /courses/{courseId}/offerings/{offeringId}:
    get:
      tags:
        - Course Offering
      summary: Details for a single course offering

      parameters:
        - name: courseId
          in: path
          description: A course identifier
          required: true
          schema:
            type: string
            format: uuid

        - name: offeringId
          in: path
          description: A course offering identifier
          required: true
          schema:
            type: string
            format: uuid

      responses:
        200:
          description: successful operation
          content:
            'application/json':
              schema:
                  $ref: '#/components/schemas/CourseOffering'
        404:
          description: invalid course and/or course offering id
          content:
            'application/json':
              schema:
                $ref: '#/components/schemas/ErrorResponse'

components:
  schemas:
    Course:
      type: object
      properties:
        id:
          type: string
          format: uuid
        name:
          type: string
          example: Thinking skills programme
        type:
          type: string
          example: TypeA
        description:
          type: string
          example: Thinking Skills Programme (TSP) description
        coursePrerequisites:
          type: array
          items:
            $ref: '#/components/schemas/CoursePrerequisite'
        audience:
          type: array
          items:
            $ref: '#/components/schemas/CourseAudience'
      required:
        - id
        - name
        - type
        - type
        - coursePrerequisites
        - audience

    CoursePrerequisite:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
      example:
        - name: gender
          description: female
        - name: risk score
          description: 'ORGS: 50+'
        - name: offence type
          description: some offence here
      required:
        - name
        - description

    CourseOffering:
      type: object
      properties:
        id:
          type: string
          format: uuid
        organisationId:
          type: string
          example: "MDI"
          description: "The unique HPMMS identifier associated with the prison hosting the offering"
        contactEmail:
          type: string
          format: email
          example: "ap-admin@digital.justice.gov.uk"
          description: "The email address of a contact for this offering"

      required:
        - id
        - organisationId
        - contactEmail

    CourseAudience:
      type: object
      properties:
        value:
          type: string
          example: "General Violence"
        id:
          type: string
          format: uuid
      required:
        - id
        - value

    ErrorResponse:
      type: object
      properties:
        status:
          type: integer
          example: 404
        errorCode:
          type: integer
        userMessage:
          type: string
          example: "Course not found"
        developerMessage:
          type: string
        moreInfo:
          type: string
      required:
        - status
